#!/bin/bash

echo " "
echo "ğŸ“± ===================================="
echo "ğŸ® GAMEHUB TOKEN - ANDROID INSTALLER"
echo "ğŸ“± ===================================="
echo " "

# Check Node.js
if ! command -v node &> /dev/null; then
    echo "âŒ Node.js is not installed!"
    echo "ğŸ“¥ Please install Node.js from: https://nodejs.org"
    exit 1
fi

echo "âœ… Node.js version: $(node --version)"

# Check Java for Android
if ! command -v java &> /dev/null; then
    echo "âš ï¸  Java not found. Android build might need Java JDK"
fi

# Install dependencies
echo " "
echo "ğŸ“¦ Installing dependencies..."
npm install

if [ $? -ne 0 ]; then
    echo "âŒ npm install failed!"
    exit 1
fi

# Build Next.js
echo " "
echo "ğŸ”¨ Building project..."
npm run build

if [ $? -ne 0 ]; then
    echo "âŒ Build failed!"
    exit 1
fi

# Install Capacitor
echo " "
echo "âš¡ Installing Capacitor..."
npm install @capacitor/core @capacitor/cli @capacitor/android

# Initialize Capacitor
echo " "
echo "ğŸ¯ Initializing Capacitor..."
npx cap init GameHubToken com.gamehub.token --web-dir out

# Add Android platform
echo " "
echo "ğŸ¤– Adding Android platform..."
npx cap add android

# Sync with Android
echo " "
echo "ğŸ”„ Syncing with Android..."
npx cap sync android

echo " "
echo "âœ… ===================================="
echo "ğŸ‰ INSTALLATION COMPLETED SUCCESSFULLY!"
echo "âœ… ===================================="
echo " "
echo "ğŸ“‹ NEXT STEPS:"
echo "   1. Run: npx cap open android"
echo "   2. Android Studio will open"
echo "   3. In Android Studio: Build â†’ Generate Signed Bundle / APK"
echo "   4. Follow the wizard to create your APK"
echo " "
echo "ğŸ”§ QUICK COMMANDS:"
echo "   ğŸ“± Open Android: npx cap open android"
echo "   ğŸ”„ Sync changes: npx cap sync android"
echo "   ğŸ—ï¸  Build APK: npm run apk-debug"
echo " "
echo "ğŸ® GameHub Token Ready for Android!"
echo " "
